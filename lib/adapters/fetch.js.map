{"version":3,"sources":["../../src/adapters/fetch.js"],"names":["fetch","url","opts","then","resp","status","toJSON","data","Promise","reject","statusText","response","processData","JSON","parse","err","text","resolve"],"mappings":"AAAA;;;;;;kBAoBe,UAAUA,KAAV,EAAiB;AAC9B,SAAO,UAACC,GAAD,EAAMC,IAAN;AAAA,WAAcF,MAAMC,GAAN,EAAWC,IAAX,EAAiBC,IAAjB,CAAsB,UAACC,IAAD,EAAS;AAClD,UAAIA,KAAKC,MAAL,IAAe,GAAnB,EAAwB;AACtB,eAAOC,OAAOF,IAAP,EAAaD,IAAb,CAAkB,UAACI,IAAD,EAAS;AAChC,iBAAOC,QAAQC,MAAR,CAAe,EAAEJ,QAAQD,KAAKC,MAAf,EAAuBK,YAAYN,KAAKM,UAAxC,EAAoDC,UAAUJ,IAA9D,EAAf,CAAP;AACD,SAFM,CAAP;AAGD,OAJD,MAIO;AACL,eAAOD,OAAOF,IAAP,EAAaD,IAAb,CAAkB,UAACI,IAAD,EAAS;AAChC,cAAIH,KAAKC,MAAL,IAAe,GAAf,IAAsBD,KAAKC,MAAL,GAAc,GAAxC,EAA6C;AAC3C,mBAAOE,IAAP;AACD,WAFD,MAEO;AACL,mBAAOC,QAAQC,MAAR,CAAeF,IAAf,CAAP;AACD;AACF,SANM,CAAP;AAOD;AACF,KAdoB,CAAd;AAAA,GAAP;AAiBD,C;;AApCD,SAASK,WAAT,CAAqBL,IAArB,EAA2B;AACzB,MAAI;AACF,WAAOM,KAAKC,KAAL,CAAWP,IAAX,CAAP;AACD,GAFD,CAEE,OAAOQ,GAAP,EAAY;AACZ,WAAOR,IAAP;AACD;AACF;;AAED,SAASD,MAAT,CAAgBF,IAAhB,EAAsB;AACpB,MAAIA,KAAKY,IAAT,EAAe;AACb,WAAOZ,KAAKY,IAAL,GAAYb,IAAZ,CAAiBS,WAAjB,CAAP;AACD,GAFD,MAEO,IAAIR,gBAAgBI,OAApB,EAA6B;AAClC,WAAOJ,KAAKD,IAAL,CAAUS,WAAV,CAAP;AACD,GAFM,MAEA;AACL,WAAOJ,QAAQS,OAAR,CAAgBb,IAAhB,EAAsBD,IAAtB,CAA2BS,WAA3B,CAAP;AACD;AACF","file":"fetch.js","sourcesContent":["\"use strict\";\n\nfunction processData(data) {\n  try {\n    return JSON.parse(data);\n  } catch (err) {\n    return data;\n  }\n}\n\nfunction toJSON(resp) {\n  if (resp.text) {\n    return resp.text().then(processData);\n  } else if (resp instanceof Promise) {\n    return resp.then(processData);\n  } else {\n    return Promise.resolve(resp).then(processData);\n  }\n}\n\nexport default function (fetch) {\n  return (url, opts)=> fetch(url, opts).then((resp)=> {\n    if (resp.status >= 400) {\n      return toJSON(resp).then((data)=> {\n        return Promise.reject({ status: resp.status, statusText: resp.statusText, response: data });\n      });\n    } else {\n      return toJSON(resp).then((data)=> {\n        if (resp.status >= 200 && resp.status < 300) {\n          return data;\n        } else {\n          return Promise.reject(data);\n        }\n      });\n    }\n  }\n\n  );\n}\n"]}